<!-- pages/orderDetail/orderDetail.wxml -->
<wxs src="../../utils/magic.wxs" module="magic" />
<view class="container">
  <view class="top-container">
    <view class="top">
      <view class="info">
        <view>
          <image class="roomImg" src="{{magic.split(OrderInfodata.roomImg)[0]}}"></image>
        </view>
        <view class="name">
          {{OrderInfodata.roomName}}ï¼ˆ{{OrderInfodata.roomType==1?'å°åŒ…':OrderInfodata.roomType==2?'ä¸­åŒ…':OrderInfodata.roomType==3?'å¤§åŒ…':OrderInfodata.roomType==4?'è±ªåŒ…':'å•†åŠ¡åŒ…'}}ï¼‰
        </view>
        <view class="share">
          <button class="share bg-primary" open-type="share"><text>åˆ†äº«</text></button>
        </view>
      </view>
      </view>
      <!-- æ—¶é—´æ®µ -->
      <view class="timeBox">
        <view class="time">
          <view class="hour">
            {{magic.splittime(OrderInfodata.startTime)[0]}}:{{magic.splittime(OrderInfodata.startTime)[1]}}
          </view>
          <view class="date">{{magic.splitkongge(OrderInfodata.startTime)[0]}}</view>
        </view>
        <view class="total border-primary">{{OrderInfodata.orderHour}}å°æ—¶</view>
        <view class="time">
          <view class="hour">
            {{magic.splittime(OrderInfodata.endTime)[0]}}:{{magic.splittime(OrderInfodata.endTime)[1]}}
          </view>
          <view class="date">{{magic.splitkongge(OrderInfodata.endTime)[0]}}</view>
        </view>
      </view>
      <!-- è®¢å•è¯¦æƒ… -->
      <view class="orderInfo">
       <view class="item">
        <view class="title">è®¢å•ç¼–å·ï¼š</view>
        <view class="logo">
          {{OrderInfodata.orderNo}}
        </view>
      </view>
      <view class="item">
        <view class="title">é—¨åº—åç§°ï¼š</view>
        <view class="logo">
          {{OrderInfodata.storeName}}
          <text class="color-primary link" bind:tap="goTencentMap">æŸ¥çœ‹åœ°å›¾</text>
        </view>
      </view>
      <view class="item">
        <view class="title">æ”¯ä»˜æ–¹å¼ï¼š</view>
        <text>{{OrderInfodata.payType===1?'å¾®ä¿¡':OrderInfodata.payType===2?'ä½™é¢':OrderInfodata.payType===3?'å›¢è´­':'å¥—é¤'}}</text>
      </view>
       <block wx:if="{{OrderInfodata.deposit}}">
        <view class="item">
           <view class="title">æ”¯ä»˜æŠ¼é‡‘ï¼š</view>
            <text>Â¥ {{OrderInfodata.deposit}} å…ƒ</text>
        </view>
       </block>
      <view class="item">
        <label class="title">ä½¿ç”¨å¡åˆ¸ï¼š</label>
        <block wx:if="{{OrderInfodata.couponName.length>0}}">
          <text>{{OrderInfodata.couponName}}</text>
        </block>
        <block wx:else>
          <text>æœªé€‰æ‹©</text>
        </block>
      </view>
      <view class="item">
        <label class="title">ä¸‹å•æ—¶é—´ï¼š</label>
        <text>{{OrderInfodata.createTime}}</text>
      </view>
      <!-- wifi -->
      <view class="item" wx:if="{{OrderInfodata.status==0||OrderInfodata.status==1}}">
        <label class="title">WIFIä¿¡æ¯ï¼š</label>
        <view class="color-primary wifi">
          {{OrderInfodata.wifiInfo}}
        </view>
      </view>
      <view class="item" wx:if="{{OrderInfodata.status==0||OrderInfodata.status==1}}">
        <label class="title">WIFIå¯†ç ï¼š</label>
        <view class="color-primary wifi">
          {{OrderInfodata.wifiPwd}}
        </view>
      </view>
    </view>
  </view>
  <view class="order-container">
    <view class="doors" wx:if="{{OrderInfodata.status === 0 || OrderInfodata.status === 1}}">
      <view class="door m-b-20 color-primary" bind:tap="damenbindchange">
        <view class="action">
          <view class="iconfont icon-damen"></view>
          <view class="text">é—¨åº—å¤§é—¨</view>
        </view>
      </view>
      <view class="door m-b-20 color-primary" bind:tap="roombindchange">
        <view class="action">
          <view class="iconfont icon-dian"></view>
          <view class="text">é€šç”µå¼€é—¨</view>
        </view>
      </view>
      <view class="door m-b-20 color-primary" bind:tap="showModal">
        <view class="action">
          <view class="iconfont icon-weizhi"></view>
          <view class="text">ç©ºè°ƒæ§åˆ¶</view>
        </view>
      </view>
      <button hover-class="button-click" class="door color-primary share {{OrderInfodata.renewBtn ?'':'disabled'}}" open-type="{{OrderInfodata.renewBtn ?'share':''}}">
        <view class="action">
          <view class="iconfont icon-fenxiang"></view>
          <view class="text">åˆ†äº«è®¢å•</view>
        </view>
      </button>
      <view class="door color-primary {{OrderInfodata.renewBtn ?'color-primary':'disabled'}}" >
        <view class="action" bind:tap="call">
          <view class="iconfont icon-kefu "></view>
          <view class="text">è”ç³»å®¢æœ</view>
        </view>
      </view>
      <view class="door color-primary {{OrderInfodata.renewBtn ?'color-primary':'disabled'}}" bind:tap="renewClick">
        <view class="action">
          <view class="iconfont icon-shalou"></view>
          <view class="text">ç»­è´¹</view>
        </view>
      </view>
      <view class="tip">Tipsï¼šåˆ†äº«æˆ¿é—´ç»™å¥½å‹ï¼Œå¥½å‹å¯ç›´æ¥æ“ä½œå¼€é—¨å¼€ç”µ</view>
    <view class="bar_btns" wx:if="{{OrderInfodata.status === 0}}">
        <view class="btnSmall left" bindtap="cancelOrder" data-info="{{OrderInfodata.status}}">
          å–æ¶ˆè®¢å•
        </view>
        <view class="btnSmall right" bindtap="goChangeDoor">æ›´æ¢æˆ¿é—´</view>
    </view>
     <view class="bar_btns" wx:if="{{OrderInfodata.status === 1}}">
        <view class="btnSmall left" bindtap="stopOrder" data-id="{{OrderInfodata.orderId}}">
          æå‰ç¦»åº—
        </view>
    </view>
    </view>
    <view class="doors" wx:else>
      <view class="door {{OrderInfodata.renewBtn ?'color-primary':'disabled'}}" >
        <view class="action" bind:tap="call">
          <view class="iconfont icon-kefu "></view>
          <view class="text">è”ç³»å®¢æœ</view>
        </view>
      </view>
      <view class="door {{OrderInfodata.renewBtn ?'color-primary':'disabled'}}" bind:tap="renewClick">
        <view class="action">
          <view class="iconfont icon-shalou"></view>
          <view class="text">ç»­è´¹</view>
        </view>
      </view>
    </view>
  </view>
  <!-- æ¸©é¦¨æç¤º -->
  <view class="notes">
    <view class="title border-primary">æ¸©é¦¨æç¤º</view>
    <view class="line">1. ä¸‹å•5åˆ†é’Ÿå†…å¯ä»¥å–æ¶ˆè®¢å•æˆ–æ›´æ¢æˆ¿é—´ï¼Œè¶…æ—¶å°†æ— æ³•å–æ¶ˆï¼</view>
    <view class="line">2. è®¢å•æ— æ³•æš‚åœï¼Œè¿Ÿåˆ°æ¶ˆè´¹ï¼ŒæŒ‰åŸé¢„è®¢æ—¶é—´å¼€å§‹è®¡è´¹ï¼</view>
    <view class="line">3. è®¢å•å¯ä»¥æå‰å¼€å§‹æ¶ˆè´¹ï¼Œæå‰å¼€å§‹æå‰ç»“æŸã€‚</view>
    <view class="line">4. ç‰¹æ®Šæƒ…å†µï¼Œæˆ–éœ€è¦å¸®åŠ©ï¼Œè¯·è”ç³»å®¢æœå¤„ç†ï¼</view>
    <view class="line">5. ç¦»åœºæ—¶è¯·å¸¦å¥½éšèº«ç‰©å“ï¼Œä»¥é˜²ä¸¢å¤±ï¼</view>
    <view class="line">6.æ”¯ä»˜çš„æŠ¼é‡‘,åœ¨è®¢å•ç»“æŸ5åˆ†é’Ÿå,è‡ªåŠ¨åŸè·¯é€€å›ï¼</view>
  </view>
</view>
<!-- ç»­å•å¼¹çª— -->
<van-dialog use-slot title="è®¢å•ç»­è´¹" show="{{ renewShow }}" show-cancel-button before-close="{{beforeCloseFunction}}">
  <view class="dialog">
    <view class="item" style="align-items: center;">
      <label>è¯·é€‰æ‹©å¢åŠ çš„æ—¶é—´ï¼š</label>
      <van-stepper value="{{ addTime }}" step="1" min="0" max="8" disable-input bind:change="onChange" />
      æ—¶
    </view>
    <view class="item">
      <label>è®¢å•åŸç»“æŸæ—¶é—´ï¼š</label>
      <text>{{OrderInfodata.endTime}}</text>
    </view>
    <view class="item">
      <label>å¢åŠ åç»“æŸæ—¶é—´ï¼š</label>
      <text>{{newTime}}</text>
    </view>
    <view class="item">
      <label>å°æ—¶å•ä»·ï¼š</label>
      <text class="color-attention">{{OrderInfodata.roomPrice}}å…ƒ</text>
      /å°æ—¶
    </view>
    <block wx:if="{{OrderInfodata.roomPrice!=OrderInfodata.workPrice}}">
      <view class="item">
        <label>é—²æ—¶å•ä»·ï¼š</label>
        <text class="color-attention">{{OrderInfodata.workPrice}}å…ƒ</text>
        /å°æ—¶
      </view>
    </block>
    <view class="item">
      <label>æ”¯ä»˜æ€»ä»·ï¼š</label>
      <text class="color-attention">{{totalPay}}</text>
      å…ƒ
    </view>
    <view class="item">
      <label>ä¼˜æƒ å¡åˆ¸ï¼š</label>
      <view class="coupon" bindtap="goCoupon">
        <block wx:if="{{submit_couponInfo.couponName}}">
          <block wx:if="{{submit_couponInfo.type == 1}}">
            <view class="price-coupon">
              {{submit_couponInfo.couponName}}(æŠµæ‰£{{submit_couponInfo.price}}å°æ—¶)
            </view>
          </block>
          <block wx:if="{{submit_couponInfo.type == 2}}">
            <view class="price-coupon">
              {{submit_couponInfo.couponName}}(æ»¡å‡{{submit_couponInfo.price}}å…ƒ)
            </view>
          </block>
          <block wx:if="{{submit_couponInfo.type == 3}}">
            <view class="price-coupon">
              {{submit_couponInfo.couponName}}(å»¶é•¿{{submit_couponInfo.price}}å°æ—¶)
            </view>
          </block>
        </block>
        <block wx:else>
          <block wx:if="{{couponCount>0}}">
            <view class="price-coupon">{{couponCount}}å¼ </view>
          </block>
          <block wx:else>
            <view class="price-coupon">æš‚æ— </view>
          </block>
        </block>
        <view class="iconfont icon-right"></view>
      </view>
    </view>
    <view class="item pay-item">
      <label>æ”¯ä»˜æ–¹å¼ï¼š</label>
      <radio-group class="pays" bindchange="radioChange">
        <label class="pay" wx:for="{{payTypes}}" wx:key="value">
          <view class="left">
            <view wx:if="{{item.value === 1}}" class="iconfont icon-weixinzhifu color-primary"></view>
            <view wx:if="{{item.value === 2}}" class="iconfont icon-pay color-primary"></view>
            {{item.name}}
          </view>
          <view class="wallet-info" wx:if="{{item.value === 2}}">
            <view class="info">è´¦æˆ·ä½™é¢: {{balance}}å…ƒ</view>
            <view class="info">èµ é€ä½™é¢: {{giftBalance}}å…ƒ</view>
          </view>
          <radio value="{{item.value}}" checked="{{item.checked}}" />
        </label>
      </radio-group>
    </view>

  </view>
</van-dialog>
<!-- å–æ¶ˆè®¢å•å¼¹çª— -->
<van-dialog use-slot title="å–æ¶ˆè®¢å•" show="{{ cancelOrderShow }}" show-cancel-button cancel-button-text="æš‚ä¸å–æ¶ˆ" confirm-button-text="ç¡®è®¤å–æ¶ˆ" bind:confirm="cancelConfirm">
  <view class="dialog">
    <view class="item">
      <label>å½“å‰ä½ç½®ï¼š</label>
      <text>{{OrderInfodata.storeName}} {{OrderInfodata.roomName}}ï¼ˆ{{OrderInfodata.roomType==1?'å°åŒ…':OrderInfodata.roomType==2?'ä¸­åŒ…':OrderInfodata.roomType==3?'å¤§åŒ…':OrderInfodata.roomType==4?'è±ªåŒ…':'å•†åŠ¡åŒ…'}}ï¼‰</text>
    </view>
    <view class="item">
      <label>é¢„çº¦æ—¶é—´ï¼š</label>
      <text>{{OrderInfodata.createTime}}</text>
    </view>
    <view class="item">
      <label>æ˜¯å¦ç¡®è®¤å–æ¶ˆè®¢å•ï¼Ÿ</label>
    </view>
    <view class="item">
      <p class="color-attention note">å–æ¶ˆè®¢å•åï¼Œè´¹ç”¨å°†ä¼šé€€è¿˜åˆ°æ‚¨åŸæ”¯ä»˜æ–¹å¼è´¦æˆ·ä¸­ï¼</p>
    </view>
  </view>
</van-dialog>
<!-- å–æ¶ˆè®¢å•æˆåŠŸå¼¹çª— -->
<van-dialog use-slot title="è®¢å•å–æ¶ˆæˆåŠŸ" show="{{ cancelOrderSuccess }}" confirm-button-text="å¥½çš„" bind:confirm="SucessConfirm">
  <view class="dialog">
    <view class="item">
      <label>å·²ä¸ºæ‚¨æˆåŠŸå–æ¶ˆä¸‹åˆ—è®¢å•</label>
    </view>
    <view class="item">
      <label>å½“å‰ä½ç½®ï¼š</label>
      <block wx:if="{{OrderInfodata.roomType == 0}}">
        <text>{{OrderInfodata.storeName}} {{OrderInfodata.roomName}} ï¼ˆç‰¹ä»·åŒ…ï¼‰</text>
      </block>
      <block wx:elif="{{OrderInfodata.roomType == 1}}">
        <text>{{OrderInfodata.storeName}} {{OrderInfodata.roomName}} ï¼ˆå°åŒ…ï¼‰</text>
      </block>
      <block wx:elif="{{OrderInfodata.roomType == 2}}">
        <text>{{OrderInfodata.storeName}} {{OrderInfodata.roomName}} ï¼ˆä¸­åŒ…ï¼‰</text>
      </block>
      <block wx:elif="{{OrderInfodata.roomType == 3}}">
        <text>{{OrderInfodata.storeName}} {{OrderInfodata.roomName}} ï¼ˆå¤§åŒ…ï¼‰</text>
      </block>
      <block wx:elif="{{OrderInfodata.roomType == 4}}">
        <text>{{OrderInfodata.storeName}} {{OrderInfodata.roomName}} ï¼ˆè±ªåŒ…ï¼‰</text>
      </block>
      <block wx:else>
        <text>{{OrderInfodata.storeName}} {{OrderInfodata.roomName}} ï¼ˆå•†åŠ¡åŒ…ï¼‰</text>
      </block>
    </view>
    <view class="item">
      <label>é¢„çº¦æ—¶é—´ï¼š</label>
      <text>{{OrderInfodata.createTime}}</text>
    </view>
    <view class="item">
      <view class="color-attention note">è®¢å•å–æ¶ˆæˆåŠŸï¼Œè´¹ç”¨å·²è¿”è¿˜åˆ°åŸæ”¯ä»˜è´¦æˆ·ï¼</view>
    </view>
  </view>
</van-dialog>

<view class="ac-control">
  <view class="ac-control__modal {{kongtiaoShow ? 'ac-control__modal--show' : ''}}" bindtap="hideModal">
    <view class="ac-control__modal-content" catchtap="stopPropagation">
      <view class="ac-control__modal-header">
        <text class="ac-control__modal-title">ç©ºè°ƒæ§åˆ¶</text>
        <text class="ac-control__modal-close" bindtap="hideModal">Ã—</text>
      </view>
      <view class="ac-control__modal-body">
        <view class="ac-control__temperature-control">
          <button class="ac-control__control-button" bindtap="adjustTemperature" data-delta="-1" >-</button>
          <view class="ac-control__temperature-display">
                <text class="ac-control__temperature-text">æ¸©åº¦</text>            
          </view>
          <button class="ac-control__control-button" bindtap="adjustTemperature" data-delta="1" >+</button>
        </view>
        <view class="ac-control__fan-control">
          <button class="ac-control__control-button" bindtap="adjustFanSpeed" data-delta="-1" >-</button>
          <view class="ac-control__fan-display">
            <text class="text">é£é‡</text>
            <view class="ac-control__fan-level">
              <view wx:for="{{5}}" wx:key="index" class="ac-control__fan-dot {{fanSpeed >= index + 1 ? 'ac-control__fan-dot--active' : ''}}"></view>
            </view>
          </view>
          <button class="ac-control__control-button" bindtap="adjustFanSpeed" data-delta="1" >+</button>
        </view>
        
        
        <view class="ac-control__mode-grid">
          <view class="ac-control__mode-button {{mode === 'cool' ? 'ac-control__mode-button--active' : ''}} " bindtap="setMode" data-mode="cool">
            <text class="ac-control__mode-icon">â„ï¸</text>
            <text>åˆ¶å†·</text>
          </view>
          <view class="ac-control__mode-button {{mode === 'heat' ? 'ac-control__mode-button--active' : ''}}" bindtap="setMode" data-mode="heat">
            <text class="ac-control__mode-icon">ğŸ”†</text>
            <text>åˆ¶çƒ­</text>
          </view>
          <view class="ac-control__mode-button {{mode === 'auto' ? 'ac-control__mode-button--active' : ''}}" bindtap="setMode" data-mode="auto">
            <text class="ac-control__mode-icon">ğŸ”„</text>
            <text>è‡ªåŠ¨</text>
          </view>
        </view>
        
        <view class="ac-control__swing-row">
          <view class="ac-control__swing-button {{verticalSwing ? 'ac-control__swing-button--active' : ''}} " bindtap="toggleVerticalSwing">
            <text class="ac-control__mode-icon">â†•ï¸</text>
            <text>ä¸Šä¸‹æ‰«é£</text>
          </view>
          <view class="ac-control__swing-button {{horizontalSwing ? 'ac-control__swing-button--active' : ''}} " bindtap="toggleHorizontalSwing">
            <text class="ac-control__mode-icon">â†”ï¸</text>
            <text>å·¦å³æ‰«é£</text>
          </view>
        </view>
        <view class="btn">
          <button class="ac-control__power-button ac-control__power-button--on" bindtap="togglePowerOn">
          å¼€æœº
          </button>
          <button class="ac-control__power-button ac-control__power-button--off" bindtap="togglePowerOff">
          å…³æœº
          </button>
        </view>
      </view>
    </view>
  </view>
</view>